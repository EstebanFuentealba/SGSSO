// Copyright (c) 2009 Solve Media Inc.


var _ACPuzzleUtil=_ACPuzzleUtil ||{callbacks:[],puzzle_count:0,puzzles:{},add_callback:function(fn,context){var i=this.callbacks.length;this.callbacks[i]=function(obj){fn.call(context,obj);};return i;},add_puzzle:function(puzzle,id){if(typeof this.get_puzzle(id)=='undefined'){this.puzzle_count++;}
this.puzzles[id]=puzzle;return this.puzzle_count;},get_puzzle:function(id){return this.puzzles[id];},make_puzzle_id:function(){var newid;var x=this.puzzle_count;do{newid='acpuz_'+x;x++;} while(typeof this.get_puzzle(newid)!='undefined');return newid;}
}
var ACPuzzleCurrent;function ACPuzzleObject(opts){var ACPuzzleInfo=opts;this.PuzzleInfo=function(){return ACPuzzleInfo;};this.theme={purple:{bg:'#5d216b',bd:'#2b0833',fg:'#fff',lk:'#004',hv:'#aaa',er:'#ff0',is:'-puV2',ls:'-puV2' },red:{bg:'#c71018',bd:'#690f0f',fg:'#fff',lk:'#004',hv:'#aaa',er:'#ff0',is:'-rdV2',ls:'-rdV2' },black:{bg:'#111',bd:'#444',fg:'#fff',lk:'#ccf',hv:'#555',er:'#f00',is:'-bkV2',ls:'-bkV2' },white:{bg:'#f8f8f8',bd:'#bbb',fg:'#000',lk:'#004',hv:'#aaa',er:'#f00',is:'-whV2',ls:'-whV2' },none:{is:'-bkV2',ls:'-whV2' },custom:{is:'-bkV2',ls:'-whV2' }
};this.locale={"en":{"INFO":"More Information...","VISUAL":"Switch to visual puzzle","AUDIO":"Switch to audio puzzle","AGAIN":"Try again","NEWPUZ":"New Puzzle","ANSWER":"Your Answer" },"yi":{"INFO":"מער אינפֿאָרמאַציע","VISUAL":"באַשטימען צו אַ וויזשאַוואַל רעטעניש","AUDIO":"באַשטימען צו אַן אַודיאָ רעטעניש","AGAIN":"פרובירט נאכאמאל","NEWPUZ":"נייַע רעטעניש","ANSWER":"דיין ענטפֿער" },"fr":{"INFO":"Plus d'informations","VISUAL":"Changez à un casse-tête visuel","AUDIO":"Changez à un casse-tête audio","AGAIN":"Essayez de nouveau","NEWPUZ":"Nouveau casse-tête","ANSWER":"Votre réponse" },"jp":{"INFO":"詳細...","VISUAL":"目視で確認コードを見る","AUDIO":"オーディオで確認コードを聞く","AGAIN":"再度入力してください","NEWPUZ":"新しい確認コード","ANSWER":"入力欄" },"it":{"INFO":"Maggiori informazioni","VISUAL":"Cambia ad un puzzle visivo","AUDIO":"Cambia a un puzzle audio","AGAIN":"Riprova","NEWPUZ":"Nuovo puzzle","ANSWER":"Tua risposta" },"de":{"INFO":"weitere Informationen zu erhalten...","VISUAL":"Umstellung auf visuelle Puzzle","AUDIO":"Umstellung auf Audio-Puzzle","AGAIN":"Nochmals versuchen","NEWPUZ":"neue Puzzle","ANSWER":"Ihre Antwort" },"es":{"INFO":"Más información","VISUAL":"Cambiar a un rompecabezas visual","AUDIO":"Cambiar a un rompecabezas de audio","AGAIN":"Inténtelo de nuevo","NEWPUZ":"Nuevo rompecabezas","ANSWER":"Su respuesta" } };this.size={"300x100":{"w":300,"h":100 },"standard":{"w":300,"h":150 },"300x150":{"w":300,"h":150 },"600x360":{"w":600,"h":360 },"336x280":{"w":336,"h":280 },"300x250":{"w":300,"h":250 } };this.css=' #adcopy-outer_ID_{background-color:_BGCOLOR_;color:_FGCOLOR_;border:1px solid _BDCOLOR_;border-radius:4px;-moz-border-radius:4px;-webkit-border-radius:4px;width:_WIDTH_px;padding:3px;margin:0px;} #adcopy-outer_ID_ tbody,#adcopy-outer_ID_ table,#adcopy-outer_ID_ span,#adcopy-outer_ID_ tr,#adcopy-outer_ID_ td,#adcopy-outer_ID_ a,#adcopy-outer_ID_ img{padding:0 !important;margin:0 !important;border:0 !important;} #adcopy-outer_ID_ td{white-space:nowrap !important;} #adcopy-instr_ID_,#adcopy-error-msg_ID_{font-size:10pt;font-family:sans-serif;} #adcopy-instr_ID_{color:_FGCOLOR_;display:inline;} #adcopy-error-msg_ID_{color:_ERCOLOR_;display:none;} #adcopy-outer_ID_ #adcopy-logo_ID_ A:hover{background-color:transparent;} #adcopy-logo_ID_{color:_FGCOLOR_;} #adcopy-outer_ID_ A{color:_LKCOLOR_;text-decoration:none;} #adcopy-link-image_ID_,#adcopy-pixel-image_ID_,#adcopy_challenge_container_ID_{display:none;} #adcopy-outer_ID_ #adcopy-link-logo_ID_ img{vertical-align:middle;} #adcopy-link-refresh_ID_,#adcopy-link-info_ID_{display:inline;} #adcopy-outer_ID_ #adcopy-link-refresh_ID_ img,#adcopy-outer_ID_ #adcopy-link-info_ID_ img,#adcopy-outer_ID_ #adcopy-link-audio_ID_ img,#adcopy-outer_ID_ #adcopy-link-image_ID_ img{vertical-align:middle;} #adcopy-puzzle-image_ID_{height:_HEIGHT_px;} #adcopy_response_ID_{width:_WIDTHM115_px !important;margin-top:2px;margin-bottom:0px;font-size:12px;} #adcopy-response-cell_ID_{height:23px;} ';this.html=' %3Cdiv id%3D"adcopy-outer_ID_"%3E %3Ctable cellpadding%3D0 cellspacing%3D0%3E %3Ctr%3E%3Ctd colspan%3D3%3E%3Cdiv id%3D"adcopy-puzzle-image_ID_"%3E%3C%2Fdiv%3E %3C%2Ftd%3E%3C%2Ftr%3E %3Ctr id%3D"adcopy-instr-row_ID_"%3E%3Ctd%3E%3Cspan id%3D"adcopy-instr_ID_"%3E_ANSWER_%3C%2Fspan%3E%3Cspan id%3D"adcopy-error-msg_ID_"%3Eerror%3C%2Fspan%3E%3C%2Ftd%3E %3Ctd%3E%3Cdiv id%3D"adcopy-pixel-image_ID_" style%3D"display:none;"%3E%3C%2Fdiv%3E%3C%2Ftd%3E %3Ctd align%3D"center"%3E%3Cspan id%3D"adcopy-logo_ID_"%3E%3Ca href%3D"javascript:ACPuzzle.moreinfo(\%27_JSID_\%27)" id%3D"adcopy-link-logo_ID_" title%3D"" %3E%3Cimg src%3D"_MEDIA_%2Fsolve_LOGOSUFFIX_.png"%3E%3C%2Fa%3E%3C%2Fspan%3E%3C%2Ftd%3E %3C%2Ftr%3E %3Ctr%3E %3Ctd id%3D"adcopy-response-cell_ID_"%3E%3Cinput type%3Dtext name%3D"adcopy_response" id%3D"adcopy_response_ID_" size%3D20 autocomplete%3D"off"%3E%3Cspan id%3D"adcopy_challenge_container_ID_"%3E%3Cinput type%3Dhidden name%3D"adcopy_challenge" id%3D"adcopy_challenge_ID_"%3E%3C%2Fspan%3E%3C%2Ftd%3E %3Ctd%3E%3C%2Ftd%3E %3Ctd align%3D"center"%3E%3Ca href%3D"javascript:ACPuzzle.reload(\%27_JSID_\%27)" id%3D"adcopy-link-refresh_ID_" title%3D"_NEWPUZ_"%3E%3Cimg src%3D"_MEDIA_%2Freload_SUFFIX_.gif"%3E%3C%2Fa %3E%3Ca href%3D"javascript:ACPuzzle.change2audio(\%27_JSID_\%27)" id%3D"adcopy-link-audio_ID_" title%3D"_AUDIO_" %3E%3Cimg src%3D"_MEDIA_%2Fnote_SUFFIX_.gif"%3E%3C%2Fa %3E%3Ca href%3D"javascript:ACPuzzle.change2image(\%27_JSID_\%27)" id%3D"adcopy-link-image_ID_" title%3D"_VISUAL_"%3E%3Cimg src%3D"_MEDIA_%2Ftext_SUFFIX_.gif"%3E%3C%2Fa %3E%3Ca href%3D"javascript:ACPuzzle.moreinfo(\%27_JSID_\%27)" id%3D"adcopy-link-info_ID_" title%3D"_INFO_" %3E%3Cimg src%3D"_MEDIA_%2Finfo_SUFFIX_.gif"%3E%3C%2Fa%3E%3C%2Ftd%3E %3C%2Ftr%3E %3C%2Ftable%3E %3C%2Fdiv%3E ';this.players={};this._ad=function(){var type=ACPuzzleInfo.mediatype;var func=this.players[type];var size=this.size[ACPuzzleInfo.size];this.byid('adcopy-link-audio').style.display='inline';this.byid('adcopy-link-image').style.display='none';if(!func){var img=this.byid('adcopy-puzzle-image');img.innerHTML='<div style="width:'+size.w+'px;"><b>ERROR:unknown media type "'+type+'" - cannot display</b></div>';return;}
func.call(this);};this.players.error=function(){var img=this.byid('adcopy-puzzle-image');img.innerHTML='';var func=ACPuzzleInfo.onerror;if(func)func.call(this);};this.players.img=function(){var url=this.media_url();var size=this.size[ACPuzzleInfo.size];var img=this.byid('adcopy-puzzle-image');var iid=this._as('adcopy-puzzle-image-image');img.innerHTML='<img src="'+url+'" alt="Solve Media Puzzle Challenge" height="'+size.h+'" width="'+size.w+'" id="'+iid+'"/>';};this.players.imgmap=function(){var url=this.media_url();var size=this.size[ACPuzzleInfo.size];var img=this.byid('adcopy-puzzle-image');var iid=this._as('adcopy-puzzle-image-image');var mid='adcopy-map-unique-'+new Date().getTime();var opt=ACPuzzleInfo.widget.player ||{};var n;var area='';var tgt='_NEW-'+new Date().getTime();for(n in opt){area=area+'<area shape="'+opt[n].shape+'" coords="'+opt[n].coords+'" href="'+this._ba(opt[n].href)+'" alt="'+opt[n].alt+'" title="'+opt[n].alt+'" target="'+tgt+'"/>';}
img.innerHTML='<img src="'+url+'" height="'+size.h+'" width="'+size.w+'" id="'+iid+'" usemap="#'+mid+'"/>'+'<map name="'+mid+'">'+area+'</map>';};this.players.aud=function(){var url=this.media_url();var width=this.size[ACPuzzleInfo.size].w;var height=this.size[ACPuzzleInfo.size].h;var media=ACPuzzleInfo.mediaserver+'/media';var o=this.byid('adcopy-puzzle-image');if(ACPuzzleInfo.caps.match(/ua\/msie/)){var match=new RegExp('^(http[s]?:)?/'+'/','i');url=url.replace(match,'http:/'+'/');}
if(ACPuzzleInfo.caps.match(/swf/)){var pswf=' <object type="application/x-shockwave-flash" data="_MEDIA_/player.swf" style="width:_WIDTH_px;height:20px;padding:0;margin:0;"> <param name="movie" value="_MEDIA_/player.swf"/> <param name="quality" value="high"/> <param name="bgcolor" value="#FFFFFF"/> <param name="menu" value="false"/> <param name="wmode" value="transparent"/> <param name="FlashVars" value="autostart=yes&amp;soundFile=_URL_" /> </object> ';var p=pswf.replace(/_URL_/g,url);p=p.replace(/_WIDTH_/g,width);p=p.replace(/_MEDIA_/g,media);o.innerHTML=p;}else{o.innerHTML='<div style="width:'+width+'px;"></div>';var a='<div style="width:'+width+'px;"><a style="text-decoration:underline;" href="'+url+';aa=1">download mp3 audio</a></div>';setTimeout(function(){o.innerHTML=a;},250);}
o.height=height;this.byid('adcopy-link-audio').style.display='none';this.byid('adcopy-link-image').style.display='inline';};this._ae=function(){var opt=ACPuzzleInfo.widget.player ||{};if(!('loop' in opt))opt.loop=1;if(!('autostart' in opt))opt.autostart=1;return opt;};this.players.vid=function(){var url=this.media_url();var size=this.size[ACPuzzleInfo.size];var img=this.byid('adcopy-puzzle-image');var iid=this._as('adcopy-puzzle-image-image');var opt=this._ae();var fv='';if(opt.autostart)fv=fv+' autoplay';if(opt.loop)fv=fv+' loop';if(opt.poster)fv=fv+' poster="'+encodeURI(opt.poster)+'"';img.innerHTML='<video src="'+url+'" height="'+size.h+'" width="'+size.w+'" id="'+iid+'"'+fv+'></video>';};this.players.swf=function(){var url=this.media_url();var size=this.size[ACPuzzleInfo.size];var img=this.byid('adcopy-puzzle-image');var iid=this._as('adcopy-puzzle-image-image');var fv='url='+encodeURI(window.location.href)+'&amp;clickTAG='+encodeURI(this._az());if(ACPuzzleInfo.caps.match(/ua\/firefox/)){img.innerHTML='<embed type="application/x-shockwave-flash" '+'src="'+url+'" '+'style="width:'+size.w+'px;height:'+size.h+'px;padding:0;margin:0;" id="'+iid+'" '+'FlashVars="'+fv+'" />';} else{img.innerHTML='<object type="application/x-shockwave-flash" '+(ACPuzzleInfo.caps.match(/ua\/msie/)? ' ':'data="'+url+'" ')+'style="width:'+size.w+'px;height:'+size.h+'px;padding:0;margin:0;" id="'+iid+'">'+'<param name="movie" value="'+url+'"/>'+'<param name="FlashVars" value="'+fv+'"/>'+'</object>';}
};this.players.flv=function(){var url=this.media_url();var size=this.size[ACPuzzleInfo.size];var img=this.byid('adcopy-puzzle-image');var iid=this._as('adcopy-puzzle-image-image');var opt=this._ae();var fv='hiddenGui=true&amp;showScaleModes=false&amp;loop='+(opt.loop?'true':'false')+'&amp;autoStart='+(opt.autostart?'true':'false');if(opt.poster)fv=fv+'&amp;startImage='+encodeURI(opt.poster);fv=fv+'&amp;flvToPlay='+encodeURI(url);img.innerHTML='<object type="application/x-shockwave-flash" data="/media/flvPlayer.swf"'+'" height="'+size.h+'" width="'+size.w+'" id="'+iid+'">'+'<param name="movie" value="/media/flvPlayer.swf"/>'+'<param name="FlashVars" value="'+fv+'"/></object>';};this.players.js=function(){var url=this.media_url();this._aw(url);};this.players.html=function(){var url=this.media_url();var size=this.size[ACPuzzleInfo.size];var img=this.byid('adcopy-puzzle-image');var iid=this._as('adcopy-puzzle-image-image');var rid='adcopy-unique-'+new Date().getTime();img.innerHTML='<div id="'+iid+'"><iframe src="'+url+'" height="'+size.h+'" width="'+size.w+'" id="'+rid+'" frameborder="0" scrolling="no"></iframe></div>';};this._af=function(){var caps='js';var flashVer=0;if(navigator.plugins !=null && navigator.plugins.length > 0){if(navigator.plugins["Shockwave Flash 2.0"]|| navigator.plugins["Shockwave Flash"]){var swVer2=navigator.plugins["Shockwave Flash 2.0"]? " 2.0":"";var fDesc=navigator.plugins["Shockwave Flash"+swVer2].description;var dArray=fDesc.split(" ");var arrayMajor=dArray[2].split(".");var vMajor=arrayMajor[0];var vMinor=arrayMajor[1];var vRev=dArray[3];if(vRev==""){vRev=dArray[4];}
if(vRev[1]=="d"){vRev=vRev.substring(1);} else if(vRev[0]=="r"){vRev=vRev.substring(1);if(vRev.indexOf("d")> 0){vRev=vRev.substring(0,vRev.indexOf("d"));}
}
flashVer=vMajor+"."+vMinor+"."+vRev;}
} else if(typeof window.ActiveXObject !='undefined'){var version;var axo;var e;/*@cc_on @*/
/*@if(@_jscript_version >=5)try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");version=axo.GetVariable("$version");tempArray=version.split(" ");version=tempArray[1].split(",").join(".");} catch(e){}
@end @*/
flashVer=version;}
if(flashVer){verArray=flashVer.split(".");var flashMajorVer=verArray[0];var flashMinorVer=verArray[1];caps=caps+',swf'+flashMajorVer;caps=caps+',swf'+flashMajorVer+'.'+flashMinorVer;if(parseInt(flashMajorVer)>=10)caps=caps+',swf';}
var c=document.createElement('canvas');if(c.getContext){caps=caps+',h5c';if(typeof c.getContext('2d').fillText=='function')caps=caps+',h5ct';}
if(document.implementation.hasFeature("http:/"+"/www.w3.org/TR/SVG11/feature#BasicStructure","1.1")){caps=caps+',svg';}
var v=document.createElement('video');if(v.canPlayType){caps=caps+',h5v';if(v.canPlayType('video/mp4;codecs="avc1.42E01E,mp4a.40.2"'))caps=caps+',v/h264';if(v.canPlayType('video/ogg;codecs="theora,vorbis"'))caps=caps+',v/ogg';if(v.canPlayType('video/3gpp;codecs="mp4v.20.8,samr"'))caps=caps+',v/3gpp';if(v.canPlayType('video/webm;codecs="vp8.0,vorbis"'))caps=caps+',v/webm';}
var a=document.createElement('audio');if(a.canPlayType){caps=caps+',h5a';if(a.canPlayType('audio/mpeg'))caps=caps+',a/mp3';if(a.canPlayType('audio/ogg;codecs="vorbis"'))caps=caps+',a/ogg';}
var ua=navigator.userAgent.toLowerCase();var bs=[{match:'iphone',vermatch:'version/' },{match:'chrome' },{match:'opera',vermatch:'version/' },{match:'android' },{match:'safari',vermatch:'version/' },{match:'trident/4',value:'msie',vers:'8' },{match:'msie' },{match:'firefox' },{match:'mozilla' }];var os=[{match:'iphone os',value:'iphone' },{match:'android',value:'android' },{match:'windows nt',value:'nt' },{match:'mac os x',value:'mac' }];for(var i in bs){var idx=ua.indexOf(bs[i].match);if(idx==-1)continue;var uam=bs[i].value || bs[i].match;var vers;caps=caps+',ua/'+uam;if(bs[i].vers){vers=bs[i].vers;}else if(bs[i].vermatch){var vi=ua.indexOf(bs[i].vermatch);if(vi !=-1){vers=parseInt(ua.substr(vi+bs[i].vermatch.length));}
}else{vers=parseInt(ua.substr(idx+bs[i].match.length+1));}
if(vers)caps=caps+',ua/'+uam+vers;break;}
for(var i in os){var idx=ua.indexOf(os[i].match);if(idx==-1)continue;var osn=os[i].value || os[i].match;caps=caps+',os/'+osn;var vst=ua.substr(idx).replace(/;.*/,'').match(/\d+/g);if(vst){caps=caps+',os/'+osn+vst[0];if(vst.length > 1)caps=caps+'.'+vst[1];}
}
return caps;}
this._ag=function(){var i=document.createElement('input');i.type='text';i.name='adcopy_response';i.setAttribute('autocomplete','off');this._ai(i);this._ak();this.byid('adcopy_response').value='';};this._ah=function(d){if('label' in d)this._ak(d.label);if('input' in d)this._aj(d.input);};this._ai=function(e){var iid=this._as('adcopy_response');var old=document.getElementById(iid);if('tabindex' in ACPuzzleInfo)e.setAttribute('tabindex',ACPuzzleInfo.tabindex);old.parentNode.replaceChild(e,old);e.id=iid;};this._aj=function(d){if(d.t=='menu'){var opt=[];var j;var i=document.createElement('select');i.name='adcopy_response';for(j=0;j<d.v.length/2;j++){opt.push({v:d.v[2*j],t:d.v[2*j+1]});}
var l=opt.length;for(j=0;j<l;j++){var x;if(d.rnd){var r=Math.floor(Math.random()* opt.length);x=opt[r];opt.splice(r,1);}else{x=opt[j];}
var e=document.createElement('option');e.value=x.v;e.text=x.t;i.options[i.length]=e;}
this._ai(i);}
if(d.t=='none'){var i=document.createElement('input');i.type='hidden';i.name='adcopy_response';i.value='';this._ai(i);}
};this._ak=function(l){var e=this.byid('adcopy-instr');if(!e)return;if(! l){var lang=this.locale[ACPuzzleInfo.lang]|| this.locale.en;l=lang.ANSWER;}
e.innerHTML=l;};this._al=function(info){var html='';if(! info)return;if(info.img){if(typeof(info.img)=='object'){for(var i in info.img){html=html+'<img src="'+info.img[i]+'" alt="" height="1" width="1"/>';}
}else{html=html+'<img src="'+info.img+'" alt="" height="1" width="1"/>';}
}
if(info.js){if(typeof(info.js)=='object'){for(var i in info.js){this._aw(info.js[i]);}
}else{this._aw(info.js);}
}
if(info.html){if(typeof(info.html)=='object'){for(var i in info.html){html=html+info.html[i];}
}else{html=html+info.html;}
}
if(html){var img=this._an();img.innerHTML=html;this._am(img);}
};this._am=function(node){if(node.nodeType !=1)return;if(node.tagName.toLowerCase()=='script'){if(node.src)this._aw(node.src);if(node.text)eval(node.text);return;}
for(var n=node.firstChild;n;n=n.nextSibling){this._am(n);}
};this._an=function(){var img=this.byid('adcopy-pixel-image');if(img)return img;var id='adcopy-pixel-image'+(ACPuzzleInfo.id ? "-"+ACPuzzleInfo.id:'');var pi=this.byid('adcopy-puzzle-image');img=document.createElement('div');img.setAttribute('id',id);img.style.display='none';pi.appendChild(img);return img;};this._ao=function(){var abt_esc='';var abt_dpy='';var abt=function(k,v){var sp='';if(!v)return;var l=k.length;for(;l<8;l++)sp=sp+' ';abt_esc=abt_esc+k+':'+sp+escape(v)+"\n";if(typeof(v)=='string'){v=v.replace(/&/g,'&amp;');v=v.replace(/</g,'&lt;');v=v.replace(/>/g,'&gt;');}
abt_dpy=abt_dpy+k+':'+sp+v+"\n";}
abt('ckey',ACPuzzleInfo.ckey);abt('url',document.location.href);abt('theme',ACPuzzleInfo.theme);abt('jsid',ACPuzzleInfo.id);abt('uid',ACPuzzleInfo.uid);abt('ip',ACPuzzleInfo.clientip);abt('caps',ACPuzzleInfo.caps);abt('ua',navigator.userAgent);abt('chid',ACPuzzleInfo.chid);abt('time',ACPuzzleInfo.timestamp);abt('lang',ACPuzzleInfo.lang);abt('type',ACPuzzleInfo.type);abt('size',ACPuzzleInfo.size);abt('mtyp',ACPuzzleInfo.mediatype);abt('murl',ACPuzzleInfo.media_url);abt('fail',ACPuzzleInfo.fail);var k,s;for(s in{config:1,pixel:1,player:1,tpdcp:1}){if(ACPuzzleInfo.widget[s]){for(k in ACPuzzleInfo.widget[s]){abt('w.'+s+'.'+k,ACPuzzleInfo.widget[s][k]);}
}
}
var div=this.byid('adcopy-debug-problem');var id='adcopy-debug-problem'+(ACPuzzleInfo.id ? "-"+ACPuzzleInfo.id:'');var jid="'"+this._au()+"'";var xid='adcopy-unique-'+new Date().getTime();var url=ACPuzzleInfo.apiserver+'/papi/_log_problem';var S=function(p,v){div.style[p]=v;};if(! div){div=document.createElement('div');div.setAttribute('id',id);document.body.appendChild(div);S('position','absolute');S('top','100px');S('left','100px');S('width','400px');S('zIndex','10000000');S('fontSize','10px');S('border','1px solid #000');S('color','#000');S('backgroundColor','#FDB');S('textAlign','left');}
var form='<hr><b>SEND DETAILS TO SUPPORT?</b><br>'+'<iframe id="'+xid+'" name="'+xid+'" src="about:blank" style="display:none;" onload="ACPuzzle._aq('+jid+')"></iframe>'+'<form enctype="multipart/form-data" action="'+url+'" target="'+xid+'" method="POST">'+'<input type="hidden" name="detail" value="'+abt_esc+'">'+'<input type="hidden" name="chid" value="'+ACPuzzleInfo.chid+'">'+'Please describe the problem<br><textarea name="about" rows=8 cols=45 style="font-size:12px;"></textarea><br>'+'Do you have anti-virus,firewall,or filtering software? Explain.<br><textarea name="avfwsw" rows=5 cols=45 style="font-size:12px;"></textarea><br>'+'<br>Add data to tech support database,you will not be contacted<br>'+'<input type=submit value="send problem report" onClick="ACPuzzle._ar('+jid+')">'+'<button type="button" onClick="ACPuzzle._ap('+jid+')">cancel</button></br>'+'</form>';ACPuzzleInfo._problem_submitted=0;div.innerHTML='<span style="float:right;background-color:#fff;border-left:1px solid #000;border-bottom:1px solid #000;'+'cursor:pointer;" onClick="ACPuzzle._ap('+jid+')">X</span></br>'+'<b>S/M - DIAGNOSTIC REPORT</b>'+'<pre style="white-space:pre-wrap;word-wrap:break-word;">'+abt_dpy+'</pre>'+form;};this._ap=function(id){var that=this._bj(id);if(that)return that._ap();var div=this.byid('adcopy-debug-problem');div.parentNode.removeChild(div);};this._aq=function(id){var that=this._bj(id);if(that)return that._aq();if(ACPuzzleInfo._problem_submitted){this._ap();}
};this._ar=function(id){var that=this._bj(id);if(that)return that._ar();ACPuzzleInfo._problem_submitted=1;};this._as=function(id){return ACPuzzleInfo.id ? id+"-"+ACPuzzleInfo.id:id;};this._at=function(){return ACPuzzleInfo.id ? '-'+ACPuzzleInfo.id:'';};this._au=function(){return ACPuzzleInfo.id ? ACPuzzleInfo.id:'';};this.byid=function(id){var name=this._as(id);return document.getElementById(name);};this._av=function(app){var head=document.getElementsByTagName('head');var node=(head.length < 1)? document.body:head[0];node.appendChild(app);};this._aw=function(url){var script=document.createElement('script');script.type='text/javascript';script.src=url;this._av(script);};this._ax=function(){var i=_ACPuzzleUtil.add_callback(this._ay,this);var url=ACPuzzleInfo.apiserver+'/papi/_challenge.js'+'?k='+ACPuzzleInfo.ckey+';f='+encodeURIComponent('_ACPuzzleUtil.callbacks['+i+']')+';l='+ACPuzzleInfo.lang+';t='+ACPuzzleInfo.type+';s='+ACPuzzleInfo.size+';c='+ACPuzzleInfo.caps+(ACPuzzleInfo.chid ? ';p='+ACPuzzleInfo.chid:'')+';ts=1317375063'+';th='+ACPuzzleInfo.theme+';r='+Math.random();if(ACPuzzleInfo.demo){if(ACPuzzleInfo.demo.acc)url=url+';acc='+ACPuzzleInfo.demo.acc;if(ACPuzzleInfo.demo.cmp)url=url+';cmp='+ACPuzzleInfo.demo.cmp;if(ACPuzzleInfo.demo.crt)url=url+';crt='+ACPuzzleInfo.demo.crt;}
if(! ACPuzzleInfo.ckey){this.byid('adcopy-outer').innerHTML='<b>no ckey specified!</b>';return;}
this._aw(url);};this.reload=function(puzzle_id){var that=this._bj(puzzle_id);if(that)return that.reload();ACPuzzleInfo.error=null;ACPuzzleInfo.errormsg=null;if(ACPuzzleInfo.stopplaying)ACPuzzleInfo.stopplaying.call(this);ACPuzzleInfo.stopplaying=null;var context=this;setTimeout(function(){context._ax.call(context);},250);};this._ay=function(obj){if(! obj)obj={};var resp=obj.ACChallengeResult;var key;ACPuzzleInfo.chid='';ACPuzzleInfo.fail='';for(key in resp){ACPuzzleInfo[key]=resp[key];}
if(!ACPuzzleInfo.chid && !ACPuzzleInfo.fail){ACPuzzleInfo.fail='get challenge failed';}
if(ACPuzzleInfo.fail){this.byid('adcopy-outer').innerHTML='<b>'+ACPuzzleInfo.fail+'</b>';return;}
this.byid('adcopy_challenge').value=ACPuzzleInfo.chid;var e=this.byid('adcopy-error-msg');var i=this.byid('adcopy-instr');var l=this.locale[ACPuzzleInfo.lang]|| this.locale.en;if(e){if(ACPuzzleInfo.error){if(ACPuzzleInfo.errormsg){e.innerHTML=ACPuzzleInfo.errormsg;}else{e.innerHTML=l.AGAIN;}
e.style.display='inline';if(i)i.style.display='none';}else{e.innerHTML='';e.style.display='none';if(i)i.style.display='inline';}
}
ACPuzzleCurrent=this;this._ad();this._ag();if(ACPuzzleInfo.widget.config)this._ah(ACPuzzleInfo.widget.config);if(ACPuzzleInfo.widget.pixel)this._al(ACPuzzleInfo.widget.pixel);if(ACPuzzleInfo.widget.tpdcp)this._al(ACPuzzleInfo.widget.tpdcp);if(ACPuzzleInfo.callback)ACPuzzleInfo.callback.call(this);ACPuzzleInfo.callback=null;ACPuzzleCurrent=null;};this.media_url=function(){if(ACPuzzleInfo.media_url)return ACPuzzleInfo.media_url;var thm=this._be();var width=this.size[ACPuzzleInfo.size].w;var height=this.size[ACPuzzleInfo.size].h;var url=ACPuzzleInfo.mediaserver+'/papi/media?c='+ACPuzzleInfo.chid+';w='+width+';h='+height;var img=this.byid('adcopy-puzzle-image');if(thm &&('fg' in thm)&&('bg' in thm)){url=url+';fg='+this._bd(thm.fg);url=url+';bg='+this._bd(thm.bg);}else{var fg,bg,vfg,vbg;var e=img;while(e){if(!fg){vfg=this._bb(e,'color','color');if(this._bc(vfg))fg=vfg;}
if(!bg){vbg=this._bb(e,'background-color','backgroundColor');if(this._bc(vbg))bg=vbg;}
if(fg && bg)break;if(e.nodeName=='BODY')break;e=e.parentNode;}
if(fg)url=url+';fg='+this._bd(fg);if(bg)url=url+';bg='+this._bd(bg);}
return url;};this._az=function(){var url=ACPuzzleInfo.apiserver+'/papi/action?c='+ACPuzzleInfo.chid;return url;};this._ba=function(url){if(!url)return url;url=url.replace(/{ac:actionurl}/,this._az());url=url.replace(/{ac:chid}/,ACPuzzleInfo.chid);url=url.replace(/{ac:userid}/,ACPuzzleInfo.uid);return url;};this._bb=function(e,p1,p2){var v;if(!e)return;if((document.defaultView)&&(document.defaultView.getComputedStyle)){v=document.defaultView.getComputedStyle(e,null)[p1];if(v)return v;v=document.defaultView.getComputedStyle(e,null)[p2];if(v)return v;v=document.defaultView.getComputedStyle(e,null).getPropertyValue(p1);if(v)return v;v=document.defaultView.getComputedStyle(e,null).getPropertyValue(p2);if(v)return v;}else if(e.currentStyle){if(e.currentStyle[p1])return e.currentStyle[p1];if(e.currentStyle[p2])return e.currentStyle[p2];}
};this._bc=function(c){if(!c)return null;if(c.match(/rgba.*,?0\)/))return null;if(c.match(/transparent/))return null;return 1;};this._bd=function(x){var c=x.replace(/#/,'');if(c.match(/^rgb/)){c=c.replace(/^.*\(/,'');c=c.replace(/[\(\)]/g,'');var a=c.split(',');for(var n in[0,1,2]){a[n]=parseInt(a[n]);a[n]=a[n].toString(16);if(a[n].length==1)a[n]='0'+a[n];}
return a[0]+a[1]+a[2];}
if(c.length==6)return c;if(c.length==3){var a=c.split('');return a[0]+a[0]+a[1]+a[1]+a[2]+a[2];}
return null;};this.change_type=function(t,puzzle_id){var that=this._bj(puzzle_id);if(that)return that.change_type(t);ACPuzzleInfo.type=t;this.reload();};this.moreinfo=function(puzzle_id){var that=this._bj(puzzle_id);if(that)return that.moreinfo();if(this.get_response()=='XYZZY'){this._ao();return;}
if(typeof(this.win)=='undefined' || this.win.closed){var url=ACPuzzleInfo.apiserver+'/public/puzzle_more_info?lang='+ACPuzzleInfo.lang;this.win=window.open(url,'POPUP',"toolbar=no,status=no,location=no,menubar=no,"+"resizable=yes,scrollbars=yes,height=600,width=650",'yes');this.win.focus();this.win.location=url;} else{this.win.focus();}
};this.change2audio=function(puzzle_id){this.change_type('aud',puzzle_id);};this.change2image=function(puzzle_id){this.change_type('img',puzzle_id);};this._be=function(){if(typeof(ACPuzzleInfo.theme)=='object')return ACPuzzleInfo.theme;return this.theme[ACPuzzleInfo.theme];};this._bf=function(){var width=this.size[ACPuzzleInfo.size].w;var height=this.size[ACPuzzleInfo.size].h;var media=ACPuzzleInfo.mediaserver+'/media';var thm=this._be();var css=this.css;var id=this._at();if(ACPuzzleInfo.theme=='none')return;css=css.replace(/_ID_/g,id);css=css.replace(/_WIDTH_/g,width);css=css.replace(/_WIDTHP1_/g,width+1);css=css.replace(/_WIDTHM115_/g,width - 115);css=css.replace(/_WIDTHM190_/g,width - 190);css=css.replace(/_HEIGHT_/g,height);css=css.replace(/_MEDIA_/g,media);css=css.replace(/_BGCOLOR_/g,thm.bg);css=css.replace(/_BDCOLOR_/g,thm.bd);css=css.replace(/_FGCOLOR_/g,thm.fg);css=css.replace(/_LKCOLOR_/g,thm.lk);css=css.replace(/_HVCOLOR_/g,thm.hv);css=css.replace(/_ERCOLOR_/g,thm.er);return css;};this._bg=function(css){var styleElement=document.createElement("style");styleElement.type="text/css";if(styleElement.styleSheet){styleElement.styleSheet.cssText=css;} else{styleElement.appendChild(document.createTextNode(css));}
this._av(styleElement);};this._bh=function(){var html=unescape(this.html);var media=ACPuzzleInfo.mediaserver+'/media';var lang=this.locale[ACPuzzleInfo.lang]|| this.locale.en;var thm=this._be();var id=this._at();var jsid=this._au();html=html.replace(/_ID_/g,id);html=html.replace(/_JSID_/g,jsid);html=html.replace(/_SUFFIX_/g,(thm.is || '-bk'));html=html.replace(/_LOGOSUFFIX_/g,(thm.ls || '-bk'));html=html.replace(/_MEDIA_/g,media);html=html.replace(/_ANSWER_/g,lang.ANSWER);html=html.replace(/_NEWPUZ_/g,lang.NEWPUZ);html=html.replace(/_AUDIO_/g,lang.AUDIO);html=html.replace(/_VISUAL_/g,lang.VISUAL);html=html.replace(/_INFO_/g,lang.INFO);return html;};this._bi=function(opts){ACPuzzleInfo.caps=this._af();if(! opts)return;if(opts.lang in this.locale){ACPuzzleInfo.lang=opts.lang;}
if(opts.size in this.size){ACPuzzleInfo.size=opts.size;}
if((opts.theme in this.theme)||(typeof(opts.theme)=='object')){ACPuzzleInfo.theme=opts.theme;}
if(opts.tabindex){ACPuzzleInfo.tabindex=opts.tabindex;}
ACPuzzleInfo.demo=opts.demo;ACPuzzleInfo.callback=opts.callback;ACPuzzleInfo.onerror=opts.onerror;ACPuzzleInfo.id=opts.id;};this.script_init=function(){this._bi(ACPuzzleOptions);if(ACPuzzleInfo.theme !='custom'){if(this.byid('adcopy_response')){return;}
document.write('<style type="text/css">'+this._bf()+'</style>');document.write(this._bh());this._ax();}else{if(document.getElementById('adcopy_challenge')){this._ax();}else{var f=window.onload;var me=this;window.onload=function(){me._ax();if(f)f();};}
}
};this._bj=function(puzzle_id){var puz;if(ACPuzzleInfo.multi && puzzle_id && ACPuzzleInfo.id !=puzzle_id){puz=_ACPuzzleUtil.get_puzzle(puzzle_id);}
return puz;};this.create=function(ckey,divid,opts){if(opts && opts.multi){if(ACPuzzleInfo.multi===false){return;}
ACPuzzleInfo.multi=true;var id=opts.id;if(!id){id=divid;opts.id=id;}
var that=this._bj(id);if(that){return that.create(ckey,divid,opts);}
if(this===ACPuzzle){var thisinfo=ACPuzzle.PuzzleInfo();var newinfo={};for(var key in thisinfo){newinfo[key]=thisinfo[key];}
var puz=new ACPuzzleObject(newinfo);return puz.create(ckey,divid,opts);}
else{_ACPuzzleUtil.add_puzzle(this,id);}
}
else if(ACPuzzleInfo){if(ACPuzzleInfo.multi){return;}
else{ACPuzzleInfo.multi=false;}
}
if(typeof ACPuzzleInfo=='undefined')ACPuzzleInfo=opts;this._bi(opts);ACPuzzleInfo.ckey=ckey;if(ACPuzzleInfo.theme=='custom'){this.reload();}else{var div=document.getElementById(divid);if(! ACPuzzleInfo.cssp){this._bg(this._bf());ACPuzzleInfo.cssp=1;}
if(div){this.destroy();ACPuzzleInfo.divid=divid;div.innerHTML=this._bh();this.reload();}
}
return this;};this.destroy=function(puzzle_id){var that=this._bj(puzzle_id);if(that)return that.destroy();if(typeof ACPuzzleInfo.divid !='undefined'){var div=document.getElementById(ACPuzzleInfo.divid);if(div)div.innerHTML='';}
};this.switch_type=function(t,puzzle_id){if(t=='audio'){change_type('aud',puzzle_id);}else{change_type('img',puzzle_id);}
};this.show_help=function(puzzle_id){this.moreinfo(puzzle_id);};this.get_challenge=function(puzzle_id){var that=this._bj(puzzle_id);if(that)return that.get_challenge();return ACPuzzleInfo.chid;};this.get_userid=function(puzzle_id){var that=this._bj(puzzle_id);if(that)return that.get_userid();return ACPuzzleInfo.uid;};this.get_response=function(puzzle_id){var that=this._bj(puzzle_id);if(that)return that.get_response();return this.byid('adcopy_response').value;};this.focus_response_field=function(puzzle_id){var that=this._bj(puzzle_id);if(that)return that.focus_response_field();this.byid('adcopy_response').focus();};};if(typeof ACPuzzleInfo=='object'){if(typeof ACPuzzle=='undefined')ACPuzzle=new ACPuzzleObject(ACPuzzleInfo);if(ACPuzzleInfo.onload){ACPuzzleInfo.onload();ACPuzzleInfo.onload=null;}
}

